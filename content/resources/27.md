### Example of **Cilium Data Flow**:

```
  flowchart TB
  subgraph Linux_Kernel["Linux Kernel"]
          TC["TC - Ingress/Egress"]
          XDP["XDP - Ingress"]
          SO["Socket Ops"]
          CG["cgroups - Pod"]
    end
      XDP --> TC
      TC --> SO
      SO --> CG
      BPF(("eBPF Programs")) -.-> XDP & TC & SO & CG

      style BPF fill:#f96,stroke:#333,stroke-width:2px
      style Linux_Kernel fill:#f5f5f5,stroke:#666
```

### iptables Limitations:

```
graph LR
    P([Packet]) --> R1[Rule 1: Match?]
    R1 -- No --> R2[Rule 2: Match?]
    R2 -- No --> R3[Rule 3: Match?]
    R3 -- No --> RN[Rule N: Match?]
    RN -- Yes --> Action[Allow/Drop]
```

### eBPF Advantages: 
```
graph LR
    P([Packet]) --> Prog[eBPF Program]
    Prog --> Dec["Decision (O(1) hash lookup)"]
    Prog --> Map[(eBPF Maps
                  Hash Tables)]
                  
    style Map fill:#fff9c4,stroke:#fbc02d
```

### Architecture Overview

```
graph TB
    subgraph Cluster["Kubernetes Cluster"]
        direction TB
        
        subgraph CP["Control Plane"]
            direction LR
            Operator["<b>Cilium Operator</b><br/><i>(Deployment)</i><br/>• CRD Management<br/>• IPAM<br/>• Cluster Mesh"]
            Relay["<b>Hubble Relay</b><br/><i>(Deployment)</i><br/>• Aggregates flows<br/>• Serves Hubble UI/CLI"]
        end

        subgraph Node1["Worker Node (DaemonSet)"]
            direction TB
            subgraph Agent["Cilium Agent"]
                direction LR
                BPF["eBPF Datapath"]
                Observer["Hubble Observer"]
                Envoy["Envoy (L7)"]
            end

            subgraph Workloads["Workloads"]
                direction LR
                PodA["Pod A"]
                PodB["Pod B"]
                PodC["Pod C"]
            end
        end
    end

    %% Connectivity
    Operator -.->|Manages| Agent
    Relay ---|Queries| Observer
    Agent ---|Secures| Workloads

    %% Styling
    style Cluster fill:#f9f9f9,stroke:#333,stroke-width:2px
    style CP fill:#fff,stroke:#757575,stroke-dasharray: 5 5
    style Node1 fill:#fff,stroke:#333
    style Agent fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    style Workloads fill:#e1f5fe,stroke:#0288d1
    style Operator fill:#f5f5f5,stroke:#333
    style Relay fill:#f5f5f5,stroke:#333
```

### Encapsulation Mode (VXLAN/Geneve)
```
graph LR
    %% Flow
    PodA([Pod A: 10.0.1.10]) --> Agent1[Cilium Agent: Node 1]
    Agent1 ==> Tunnel{{"VXLAN / Geneve Tunnel"}}
    Tunnel ==> Agent2[Cilium Agent: Node 2]
    Agent2 --> PodB([Pod B: 10.0.2.20])



    style Tunnel fill:#fff9c4,stroke:#fbc02d
    style Agent1 fill:#fff3e0,stroke:#ef6c00
    style Agent2 fill:#fff3e0,stroke:#ef6c00
```

### Native Routing (Direct Routing)
```
graph LR
    %% Flow
    PodA([Pod A: 10.0.1.10]) --> Agent1[Cilium Agent: Node 1]
    Agent1 <== "Native IP Routing (BGP / VPC Routes)" ==> Agent2[Cilium Agent: Node 2]
    Agent2 --> PodB([Pod B: 10.0.2.20])



    style Agent1 fill:#fff3e0,stroke:#ef6c00
    style Agent2 fill:#fff3e0,stroke:#ef6c00
```

### Traditional IP-based Security
```
graph LR
    %% Components
    PodA([Pod A: 10.0.1.5])
    FW{Firewall}
    PodB([Pod B])

    %% Flow
    PodA -->|"Traffic (Src IP: 10.0.1.5)"| FW
    FW -->|"Allow 10.0.1.5"| PodB

    style FW fill:#ffebee,stroke:#c62828
```

### Cilium Identity-based Security
```

```