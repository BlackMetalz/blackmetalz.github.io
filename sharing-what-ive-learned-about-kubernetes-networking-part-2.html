<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="kienlt" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="k8s, Knowledge Base, " />

<meta property="og:title" content="Sharing What I&#39;ve Learned About Kubernetes Networking - Part 2 "/>
<meta property="og:url" content="/sharing-what-ive-learned-about-kubernetes-networking-part-2.html" />
<meta property="og:description" content="" />
<meta property="og:site_name" content="Kienlt&#39;s notebook" />
<meta property="og:article:author" content="kienlt" />
<meta property="og:article:published_time" content="2025-01-20T00:00:00+07:00" />
<meta name="twitter:title" content="Sharing What I&#39;ve Learned About Kubernetes Networking - Part 2 ">
<meta name="twitter:description" content="">

        <title>Sharing What I&#39;ve Learned About Kubernetes Networking - Part 2  · Kienlt&#39;s notebook
</title>



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/"><span class=site-name>Kienlt's notebook</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       "/"
                                    >Home</a>
                                </li>
                                <li ><a href="/categories.html">Categories</a></li>
                                <li ><a href="/tags.html">Tags</a></li>
                                <li ><a href="/archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="/sharing-what-ive-learned-about-kubernetes-networking-part-2.html">
                Sharing What I've Learned About Kubernetes Networking - Part 2
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>In the second part, I will talk about Container network interface (CNI), Cilium CNI and some compare with Network policies and Cilium network policies.</p>
<h1>CNI</h1>
<h3>What is CNI:</h3>
<ul>
<li>Is a framework for configuring network interfaces in Linux container , providing connectivity and ensure network isolation.</li>
<li>CNI Plugin standarize and simplify Kubernetes networking.</li>
</ul>
<h3>How CNI Works:</h3>
<ul>
<li>CNI works by invoke network plugin that handle network configuration for containers. When a container is created, the container runtime call the CNI plugin to setup the container network interface</li>
<li>Works in K8S:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">Kube</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">Kubelet</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">Container</span><span class="w"> </span><span class="n">Runtime</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">container</span><span class="p">,</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">namespace</span>
<span class="w">                                           </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">invoke</span><span class="w"> </span><span class="n">CNI</span><span class="p">,</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">veth</span><span class="w"> </span><span class="n">then</span><span class="w"> </span><span class="nf">map</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">container</span><span class="w"> </span><span class="n">network</span>
</code></pre></div>

<h3>CNI specification:</h3>
<ul>
<li>A Json configuration file that specifies the desired network setup.</li>
<li>Standard commands: ADD, DEL, CHECK to manage network interfaces.</li>
<li>Plugin must handle these command and return results in predefined format.</li>
</ul>
<h3>CNI community popularity:</h3>
<p>The following table summarizes different GitHub metrics to give you an idea of each project's popularity and activity levels. This data was collected in December 2024.</p>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Stars</th>
<th>Forks</th>
<th>Contributors</th>
</tr>
</thead>
<tbody>
<tr>
<td>Canal</td>
<td>718</td>
<td>100</td>
<td>20</td>
</tr>
<tr>
<td>Flannel</td>
<td>8.9k</td>
<td>2.9k</td>
<td>234</td>
</tr>
<tr>
<td>Calico</td>
<td>6.1k</td>
<td>1.4k</td>
<td>360</td>
</tr>
<tr>
<td>Weave</td>
<td>6.6k</td>
<td>672</td>
<td>84</td>
</tr>
<tr>
<td>Cilium</td>
<td>20.5k</td>
<td>3k</td>
<td>868</td>
</tr>
</tbody>
</table>
<h1>Cilium CNI</h1>
<h3>What is Cilium</h3>
<ul>
<li>Cilium is an open-source networking and security solution designed for Kubernetes and other container orchestration platforms. Its primary purpose is to provide secure and efficient network connectivity between application services deployed in cloud-native environments. Cilium leverages eBPF (extended Berkeley Packet Filter) technology to dynamically insert code into the Linux kernel, enabling high-performance packet processing and security enforcement.</li>
</ul>
<p>As a comprehensive CNI (Container Network Interface) plugin, Cilium offers advanced networking features, robust security policies, and deep observability capabilities. These features make it an ideal choice for modern cloud-native applications that require scalable and secure network infrastructure.</p>
<h3>Key Features</h3>
<ul>
<li>
<p><strong>eBPF</strong>
Cilium uses eBPF to dynamically insert code into the Linux kernel, enabling efficient packet processing and security enforcement.</p>
</li>
<li>
<p><strong>Network Policies</strong>
Cilium implements Kubernetes Network Policies and extends them with more advanced features, allowing fine-grained control over network traffic.</p>
</li>
<li>
<p><strong>Service Mesh Integration</strong>
Cilium integrates seamlessly with service meshes like Istio, providing enhanced networking capabilities and security.</p>
</li>
<li>
<p><strong>Observability</strong>
Cilium offers robust observability features through Hubble, which provides deep visibility into network traffic and security events.</p>
</li>
</ul>
<h3>eBPF explain</h3>
<p>I think you haven't understand clear about eBPF ( so am i), so i spend time to read document, try to understand it and explain it here xD.</p>
<ul>
<li>First, i think you need to check Cilium is enable in hybrid mode or strict mode or not</li>
</ul>
<div class="highlight"><pre><span></span><code>kubectl -n kube-system edit configmap cilium-config
</code></pre></div>

<p>Looks for line <code>kube-proxy-replacement</code>, if it is empty (<code>""</code>), it is running in hybrid mode and you can see by type <code>iptables -L</code></p>
<ul>
<li>
<p>Second, check kernel support or not: Cilium generally requires a kernel version &gt;= 4.19 for basic eBPF functionality and &gt;= 5.4 for kube-proxy replacement. So it will mostly about supported xD</p>
</li>
<li>
<p>Third, lets focus into main objective.</p>
<ul>
<li>
<p>Cilium with eBPF is generally faster than iptables. eBPF (extended Berkeley Packet Filter) allows Cilium to dynamically insert code into the Linux kernel, enabling efficient packet processing and security enforcement. This approach reduces the overhead associated with traditional iptables-based packet filtering and routing.</p>
</li>
<li>
<p>Iptables operates in user space and relies on a series of rules to manage network traffic, which can become complex and slow as the number of rules increases. In contrast, eBPF operates in the kernel space, allowing for more direct and efficient handling of network packets. This results in lower latency and higher throughput, making Cilium with eBPF a more performant solution for Kubernetes networking.</p>
</li>
</ul>
</li>
</ul>
<p><a href="https://x.com/diptanu/status/899424568422486016">Check out this tweet</a></p>
<ul>
<li>Examples of how Cilium utilizes eBPF: Load Balancing<ul>
<li>Use Case: Cilium implements a high-performance, distributed load balancer for Kubernetes services</li>
<li>eBPF Functionality:<ul>
<li>eBPF programs attached to networking hooks can direct packets to the correct backend pod without relying on iptables.</li>
<li>Example: A packet arriving for ClusterIP is intercepted by an eBPF program, which selects a pod backend based on a consistent hash algorithm and forwards the packet directly.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3>Common commands of cilium</h3>
<div class="highlight"><pre><span></span><code>cilium-health status
cilium status
</code></pre></div>

<h3>Cilium Observability: Hubble</h3>
<ul>
<li>There are many way to enable Hubble and Hubble UI, so i won't talk details in here.</li>
<li>View network flows in real-time: <code>hubble observe</code></li>
<li>Port forward to use hubble UI: <code>kubectl port-forward -n kube-system svc/hubble-ui 12000:80</code>
<img alt="alt text" src="images/2025/01/20th_1.png">
As you can see, very useful for Observability, debugging and tracing!</li>
</ul>
<h1>Cilium Network policies</h1>
<h3>Comparison</h3>
<ul>
<li><strong>Kubernetes Network Policies</strong>: Kubernetes network policies are used to control the traffic between pods. They are defined using the NetworkPolicy resource.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow-nginx</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="nt">policyTypes</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Egress</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">from</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">to</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">podSelector</span><span class="p">:</span>
<span class="w">        </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">          </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>

<ul>
<li><strong>Cilium Network Policies</strong>: Cilium extends the capabilities of Kubernetes network policies by leveraging eBPF. Cilium policies can be more expressive and can include L7 (Layer 7) rules.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cilium.io/v2</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CiliumNetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow-nginx</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">endpointSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">fromEndpoints</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">frontend</span>
<span class="w">    </span><span class="nt">toPorts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80&quot;</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">  </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">toEndpoints</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">    </span><span class="nt">toPorts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8080&quot;</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">toServices</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">k8sService</span><span class="p">:</span>
<span class="w">        </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">        </span><span class="nt">serviceName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external-service</span>
<span class="w">  </span><span class="nt">l7Rules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GET</span>
<span class="w">      </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api&quot;</span>
</code></pre></div>

<h3>Real example of Cilium Network policies</h3>
<ul>
<li>Assume: I have 3 namespace: default, test, python-app. I have pod with tools for testing connection</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">kubectl</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">kienlt</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="o">--</span><span class="n">image</span><span class="o">=</span><span class="n">kienlt992</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">tools</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s2">&quot;sleep infinity&quot;</span>
</code></pre></div>

<ul>
<li>I created pods kienlt-linux-tools in 2 namespace: default and test. Testing connection from both pod in different namespace</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">vz</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="p">.</span><span class="n">python</span><span class="o">-</span><span class="n">app</span><span class="p">.</span><span class="n">svc</span><span class="w"> </span><span class="mi">5000</span>
<span class="n">python</span><span class="o">-</span><span class="n">api</span><span class="o">-</span><span class="n">app</span><span class="o">-</span><span class="n">production</span><span class="p">.</span><span class="n">python</span><span class="o">-</span><span class="n">app</span><span class="p">.</span><span class="n">svc</span><span class="w"> </span><span class="p">(</span><span class="mf">10.43.67.70</span><span class="err">:</span><span class="mi">5000</span><span class="p">)</span><span class="w"> </span><span class="k">open</span>
<span class="o">/</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">curl</span><span class="w"> </span><span class="ss">&quot;http://python-api-app.rke2-cluster.kienlt.local/secret&quot;</span>
<span class="o">[</span><span class="n">database</span><span class="o">]</span>
<span class="n">database_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localhost</span>
<span class="n">database_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">admin_production</span>
<span class="n">database_pass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">secret123</span>
</code></pre></div>

<ul>
<li>Ok, the task will be block access to path secret from default namespace but allow other for demo. Here is the policy
Lets get the label firt!</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="l l-Scalar l-Scalar-Plain">k get pod -n python-app -oyaml|grep labels -A2</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">labels</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="nt">app.kubernetes.io/instance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-api-app-production</span>
<span class="w">      </span><span class="nt">app.kubernetes.io/managed-by</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Helm</span>
</code></pre></div>

<p>Then rule will come after with information above</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cilium.io/v2</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CiliumNetworkPolicy</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">deny-secret-path</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-app</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">endpointSelector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app.kubernetes.io/instance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-api-app-production</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">fromEndpoints</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">    </span><span class="nt">toPorts</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80&quot;</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">        </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Deny access to /secret</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET&quot;</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/secret$&quot;</span>
<span class="w">        </span><span class="c1"># Allow access to other GET requests</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET&quot;</span>
<span class="w">          </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/.*&quot;</span>
</code></pre></div>

<p>More example can be found in here: <a href="https://archive.fosdem.org/2020/schedule/event/replacing_iptables_with_ebpf/attachments/slides/3622/export/events/attachments/replacing_iptables_with_ebpf/slides/3622/Cilium_FOSDEM_2020.pdf">replacing_iptables_with_ebpf</a></p>
<ul>
<li><strong>Key Differences</strong>:<ul>
<li>Layer 7 Policies: Cilium supports L7 policies (e.g., HTTP methods and paths), while Kubernetes network policies are limited to L3/L4 (IP and port).</li>
<li>Integration with eBPF: Cilium uses eBPF for efficient packet processing, which can provide better performance and more advanced features.</li>
<li>Policy Syntax: Cilium policies use CiliumNetworkPolicy and have a different syntax compared to Kubernetes NetworkPolicy.</li>
</ul>
</li>
</ul>
<h1>Conclusion</h1>
<h1>Reference:</h1>
<ul>
<li><a href="https://ranchermanager.docs.rancher.com/">https://ranchermanager.docs.rancher.com/</a></li>
<li><a href="https://docs.cilium.io/en/stable/overview/intro/">https://docs.cilium.io/en/stable/overview/intro/</a></li>
<li><a href="https://cilium.io/blog/2018/04/17/why-is-the-kernel-community-replacing-iptables/">https://cilium.io/blog/2018/04/17/why-is-the-kernel-community-replacing-iptables/</a></li>
<li><a href="https://archive.fosdem.org/2020/schedule/event/replacing_iptables_with_ebpf/attachments/slides/3622/export/events/attachments/replacing_iptables_with_ebpf/slides/3622/Cilium_FOSDEM_2020.pdf">replacing_iptables_with_ebpf</a></li>
</ul>


             
 
            
            
            







            <hr/>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2025-01-20T00:00:00+07:00">Mon 20 January 2025</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#knowledge-base-ref">Knowledge Base</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags.html#k8s-ref">k8s
                    <span class="superscript">2</span>
</a></li>
            </ul>
<h4>Contact</h4>
<div id="sidebar-social-link">
</div>
            





            





        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>




    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>